(function($){$(function(){var po=document.createElement("script");po.type="text/javascript";po.async=true;po.src="//apis.google.com/js/plusone.js";var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(po,s);if(true===/^\/blog\/post\/\d+/.test(document.location.pathname)){pix.trackingClick()}})})(jQuery);function _(s,lang){if(!i18n)return s;if(!s&&!!lang){this.lang=lang}else{l=lang||this.lang||"en_US";return i18n[s]?i18n[s][l]||i18n[s]["en_US"]||s:s}}i18n={"Share to":{en_US:"Share to ",zh_TW:"分享至",ja_JP:"共有",zh_CN:"分享至"}};_(null,"zh_TW");pix=pix||{};if("undefined"!==typeof JSON){pix.stringify=JSON.stringify;pix.parse=JSON.parse}pix.blogsharelog=function(service){jQuery.get("/blog/sharelog?url="+encodeURIComponent(document.location)+"&service="+service)};jQuery(window).load(function(){var param={column:2,display:"",content:0},img=new Image;param.display=screen.width+"x"+screen.height;param.content=jQuery(".article-content:first").width();jQuery("#links>div").each(function(){if("none"!==jQuery(this).css("float")){param.column=3;return false}});img.src="http://pixanalytics.com/b.gif?content="+param.content+"&display="+param.display+"&column="+param.column});pix.trackingClick=function(){var ck_url="http://pixanalytics.com/ck.gif";ck_url+="?referrer="+encodeURIComponent(document.referrer);ck_url+="&pix.openid="+encodeURIComponent(pix.openid);ck_url+="&pix.owner="+encodeURIComponent(pix.owner);ck_url+="&pix.visitor="+encodeURIComponent(pix.visitor);ck_url+="&pix.login_name="+encodeURIComponent(pix.login_name);jQuery("div.article-content").on("click","a",function(){var url=ck_url;var $this=jQuery(this);var img=new Image;url+="&pos=content";url+="&href="+encodeURIComponent($this.attr("href"));url+="&text="+encodeURIComponent($this.html());url+="&r="+Math.random();img.src=url;return});jQuery("#links").on("click","a",function(){var url=ck_url;var $this=jQuery(this);var img=new Image;url+="&pos=sidebar";url+="&href="+encodeURIComponent($this.attr("href"));url+="&text="+encodeURIComponent($this.html());url+="&r="+Math.random();img.src=url;return});jQuery(".article-body").on("click",".pix-related-post a",function(){var url=ck_url;var $this=jQuery(this);var data=$this.data();var img=new Image;var articleCategory=jQuery("#article-box").find(".title").data("site-category")||jQuery("#main").find(".header-title").data("site-category");url+="&pos=related-post-"+data.source;url+="&href="+encodeURIComponent($this.attr("href"));url+="&text="+encodeURIComponent($this.html());url+="&r="+Math.random();if("yahoopartner"===data.source){url+="&source="+data.source;url+="&article_category="+encodeURIComponent(articleCategory);url+="&gd_category="+encodeURIComponent(data.category);url+="&gd_price="+encodeURIComponent(data.price);url+="&gd_name="+encodeURIComponent(data.title)}img.src=url;return})};pix.bookmarkInit=function(title){function _bookmark_linksInit(){var fb_href=jQuery('meta[property="og:url"]').attr("content");var gplus_href=fb_href;return['<!-- MURMUR --><a title="'+_("Share to")+'MURMUR" href="javascript:desc=\'\';if(window.getSelection)desc=window.getSelection();if(document.getSelection)desc=document.getSelection();if(document.selection)desc=document.selection.createRange().text;void(open(\'http://murmur.tw/?sharelink=\'+encodeURIComponent(document.location)));"><img src="//s.pixfs.net/blog/images/common/murmur.gif" title="MURMUR" alt="MURMUR" border="0" style="width:20px;height:20px;"></a>','<!-- facebook --><a title="'+_("Share to")+"facebook\" href=\"javascript:desc='';if(window.getSelection)desc=window.getSelection();if(document.getSelection)desc=document.getSelection();if(document.selection)desc=document.selection.createRange().text;void(open('http://www.facebook.com/share.php?u='+encodeURIComponent('"+fb_href+'\')+\'&t=\'+encodeURIComponent(document.title.split(\'@\')[0].replace(/([\\s]*$)/g,\'\'))));"><img src="//s.pixfs.net/blog/images/common/facebook.gif" title="facebook" alt="facebook" border="0" style="width:18px;height:20px;"></a>','<!-- PLURK --><a title="'+_("Share to")+'PLURK" href="javascript:desc=\'\';if(window.getSelection)desc=window.getSelection();if(document.getSelection)desc=document.getSelection();if(document.selection)desc=document.selection.createRange().text;void(open(\'http://www.plurk.com/?qualifier=shares&status=\'+encodeURIComponent(location.href)));"><img src="//s.pixfs.net/blog/images/common/plurk.gif" title="PLURK" alt="PLURK" border="0" style="width:18px;height:20px;"></a>','<!-- twitter --><a title="'+_("Share to")+'twitter" href="javascript:desc=\'\';if(window.getSelection)desc=window.getSelection();if(document.getSelection)desc=document.getSelection();if(document.selection)desc=document.selection.createRange().text;void(open(\'http://twitter.com/?status=\'+encodeURIComponent(location.href+\' (\'+document.title.split(\'@\')[0].replace(/([\\s]*$)/g,\'\')+\')\')));"><img src="//s.pixfs.net/blog/images/common/twitter.gif" title="twitter" alt="twitter" border="0" style="width:18px;height:20px;"></a>','<!-- google plus --><div style="display:inline-block; *display: none;"><div class="g-plusone" data-size="medium" data-annotation="none" data-href="'+gplus_href+'"></div></div>','<!-- facebook iframe --><iframe src=" http://www.facebook.com/plugins/like.php?href='+encodeURIComponent(fb_href)+'&amp;layout=button_count&amp;show_faces=false&amp;width=90&amp;action=like&amp;font=arial&amp;colorscheme=light&amp;height=21" scrolling="no" frameborder="0" style="border:none; overflow:hidden; width:90px; height:21px;" allowTransparency="true"></iframe>']}var bookmark_links=_bookmark_linksInit();jQuery(function(){bookmark_links.unshift(title);jQuery(".bookmark").html(bookmark_links.join("\n"))})};jQuery(".bookmark a[title*=MURMUR]").live("click",function(){pix.blogsharelog("murmur")});jQuery(".bookmark a[title*=facebook]").live("click",function(){pix.blogsharelog("facebook")});jQuery(".bookmark a[title*=PLURK]").live("click",function(){pix.blogsharelog("plurk")});jQuery(".bookmark a[title*=twitter]").live("click",function(){pix.blogsharelog("twitter")});jQuery("div.hslice.box").live("mouseover",function(){jQuery(this).find("h4 > a").css("display","inline").show()}).live("mouseout",function(){jQuery(this).find("h4 > a").hide()});(function($,window){$(document).ready(function(){"use strict";var emmaAPIDomain="//emma.pixnet.cc";var queryURLPara=function(para){var match=new RegExp("[?&]"+para+"=([^&]*)").exec(window.location.search);return match&&decodeURIComponent(match[1].replace(/\+/g," "))};var _body=$("body");var _idleIsEnabled=function(){return"none"===_body.data("mobile-mode")&&"none"!==_body.data("showing-advertisement")&&pix.owner!==pix.user_name&&/\/blog\/post/.test(document.location.pathname)}();if(_idleIsEnabled){window.pix.f.blog.idle={info:null,ele:null,constant:{activeClass:"active",adsenseBlock:"block"===_body.data("adsense-state"),dfpSlotId:_body.data("dfp-slot-id"),adsenseInfo:{slot:{large:["336x280","8126760864"],small:["300x250","3696561267"]}},adSize:0===(new Date).getDay()%2?"large":"small",idleDemo:"1"===queryURLPara("idlepop")},render:function(){var _idle=this;_body.append('<div id="idle-pop"></div>');$.getScript("//libs.pixfs.net/jsrender/jsrender.js").done(function(){var $=jQuery;if(!$.fn.render){_idle.info=null;return}$("#idle-pop").html($("#idleTemplate").render(_idle.info));_idle.ele=function(){var _ele={};_ele.wrapper=$(document.getElementById("idle-pop"));_ele.idlePop=_ele.wrapper.find(".idle-pop");_ele.masker=_ele.wrapper.find(".modal-bg");_ele.dialog=_ele.wrapper.find(".modal-dialog");_ele.close=_ele.wrapper.find(".modal-close");_ele.ad=_ele.wrapper.find(".adsbygoogle");return _ele}();_idle.insertAd();_idle.info.isFalconEmpty&&_idle.falconFallback();_idle.bindEvent();_idle.show()})},bindEvent:function(){var _idle=this,_ownerName=_idle.info.user.name;_idle.ele.close.add(_idle.ele.masker).on("click.hideIdlePop",function(event){event.preventDefault();_idle.hide()});_idle.ele.dialog.find(".blogger-info__follow").on("click.follow",function(event){event.preventDefault();var followLink="//panel.pixnet.cc/pixfront/addsubspopup?fromuser="+_ownerName+"&user="+_ownerName+"&popup=1",windowSize="width=340, height=236";if(null===pix.user_name){followLink="https://www.pixnet.net/?done="+encodeURIComponent(followLink);windowSize=""}window.open(followLink,"pix_add_sub",windowSize)});(function bindIdlePopGA(){(function(i,s,o,g,r,a,m){i["GoogleAnalyticsObject"]=r;i[r]=i[r]||function(){(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date;a=s.createElement(o),m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)})(window,document,"script","//www.google-analytics.com/analytics.js","ga");ga("create","UA-408650-10","auto",{name:"idlePop"});ga("idlePop.send","pageview");_idle.ele.close.on("click.idlePopGA",function(event){ga("idlePop.send","event","close","click","btn")});_idle.ele.masker.on("click.idlePopGA",function(event){ga("idlePop.send","event","close","click","masker")});_idle.ele.wrapper.find(".idle-related-posts").on("click.idlePopGA",".idle-related-post",function(event){ga("idlePop.send","event","post","click","第"+($(this).index()+1)+"篇")});_idle.ele.wrapper.find(".blogger-info").on("click.idlePopGA","a",function(event){var _class=$(this).prop("class").replace("blogger-info__","");ga("idlePop.send","event","profile","click",""===_class?"blog":_class)})})()},insertAd:function(){var _idle=this,_adSize=_idle.constant.adSize,_adsenseInfo=_idle.constant.adsenseInfo,_adDimension=_adsenseInfo.slot[_adSize][0].split("x");if("small"===_adSize){_idle.ele.wrapper.addClass("idle--small")}if(_idle.constant.adsenseBlock){_idle.ele.ad.append('<div class="sitemajidr" model="300x250" section="content" pos="BTF1"></div>');$.getScript("//ad.sitemaji.com/ysm_pixnet.js")}else if(_idle.constant.dfpSlotId){$.getScript("//www.googletagservices.com/tag/js/gpt.js").done(function(){var _idleDfpWrapperId="idle-gpt-ad";var googletag=window.googletag||{};googletag.cmd=googletag.cmd||[];googletag.cmd.push(function(){googletag.defineSlot(_idle.constant.dfpSlotId,[parseInt(_adDimension[0],10),parseInt(_adDimension[1],10)],_idleDfpWrapperId).addService(googletag.pubads());googletag.pubads().enableSingleRequest();googletag.enableServices()});_idle.ele.wrapper.find(".idle-adsense").html('<div id="'+_idleDfpWrapperId+'"></div>');googletag.cmd.push(function(){googletag.display(_idleDfpWrapperId)})})}else{_idle.ele.ad.attr("data-ad-slot",_adsenseInfo.slot[_adSize][1]).css({width:_adDimension[0],height:_adDimension[1]});$.getScript("//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js").done(function(){(adsbygoogle=window.adsbygoogle||[]).push({})})}},getInfo:function(){var _idle=this,_owner=pix.owner,_blogInfo;_idle.info=_idle.info||{};_idle.info.posts=[];$.when($.ajax({url:emmaAPIDomain+"/users/"+_owner+"?with_blog=1&format=json",dataType:"jsonp"}).done(function(data){_blogInfo=data}),$.ajax({url:emmaAPIDomain+"/blog/articles/hot?user="+_owner+"&trim_user=1&limit=3&with_body=1&format=json",dataType:"jsonp"}).done(function(data){var articlesLen=data.articles.length;for(var i=articlesLen-1;i>=0;i--){data.articles[i].body=$("<div>").html($("<div>").html(data.articles[i].body).text()).text()}0<articlesLen&&(_idle.info.posts[1]=data.articles[0]);1<articlesLen&&(_idle.info.posts[2]=data.articles[1]);_idle.bankPost=data.articles[2]}),$.ajax({url:"//falcon.pixanalytics.com/ad/jsonp/1013",dataType:"jsonp",data:{demo_ad_no:queryURLPara("demo_ad_no")}}).done(function(data){_idle.info.posts[0]=data.ads.length?data.ads[0]:null})).done(function(){var _emptyData={title:"",thumb:"",link:"",body:""};_idle.info.user=_blogInfo.user||{};_idle.info.blog=_blogInfo.blog||{};if(null===_idle.info.posts[0]){_idle.info.posts[0]=_emptyData;_idle.info.isFalconEmpty=true}_idle.render()})},falconFallback:function(){var _idle=this;$.ajax({url:"//api.i.pixnet.cc/more/like/"+$("base")[0].href.replace(/^https?\:\/\//,""),dataType:"jsonp",data:{from:"yahoopartner"}}).done(function(data){var _post,_targetLink=_idle.ele.wrapper.find(".idle-related-post").eq(0);if(data.length){_post=data}else{_post=_idle.bankPost;if(!_idle.bankPost){_targetLink.remove();return}}_idle.info.posts[0]=_post;_targetLink.attr("href",_post.link);_targetLink.children("img").attr("src",_post.thumb);_targetLink.find("h4").text(_post.title);_targetLink.find(".idle-related-post__desc").text(_post.body||"")})},show:function(){var _idle=this;if(_idle.ele.idlePop.hasClass(_idle.constant.activeClass)){return}_idle.ele.idlePop.addClass(_idle.constant.activeClass)},hide:function(){var _idle=this;_idle.ele.idlePop.removeClass(_idle.constant.activeClass)},active:function(){var _idle=this;if(!$.fn.render){$.getScript("//libs.pixfs.net/jsrender/jsrender.js")}if(_idle.info&&_idle.info.posts){_idle.show()}else{_idle.getInfo()}}};if(window.pix.f.blog.idle.constant.idleDemo){setTimeout(function(){window.pix.f.blog.idle.active()},5e3)}}var match=/[?&]demo_ad_no=([^&]*)/.exec(window.location.search),adQueryNo=match&&decodeURIComponent(match[1].replace(/\+/g," "))||"";if(window.pix.owner===window.pix.user_name){return false}$.ajax({type:"GET",async:false,url:"//falcon.pixanalytics.com/ad/jsonp/1020",dataType:"jsonp",data:{demo_ad_no:adQueryNo},success:function(data){if(!data.error&&data.ad_list&&0<data.ad_list.length){var ad=data.ad_list[0],element=$('<div id="falcon-ad-right-fixed-block">'+'<a href="'+ad.link+'" target="_blank" ">'+'<img src="'+ad.thumb+'" alt="falcon ad" class="ad-img"></a>'+'<div class="ad-title">'+ad.title+"</div>"+'<div class="cancel-btn">X</div>'+"</div>"),timeoutId;$("body").append(element).on("click","#falcon-ad-right-fixed-block .cancel-btn",function(){var image=new Image(1,1),optout=new Image(1,1);image.src=ad.closelink;optout.src=ad.opt_out_url;element.remove();window.clearTimeout(timeoutId)});timeoutId=window.setTimeout(function(){element.animate({right:0},1e3)},1e3)}}})})})(jQuery,window);